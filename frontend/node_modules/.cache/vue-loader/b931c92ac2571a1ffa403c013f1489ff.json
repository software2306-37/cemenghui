{"remainingRequest":"D:\\Program Files (x86)\\ys\\project\\springboot\\测盟汇系统\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\Program Files (x86)\\ys\\project\\springboot\\测盟汇系统\\frontend\\src\\views\\MeetingManage.vue?vue&type=style&index=0&id=a918f894&scoped=true&lang=css","dependencies":[{"path":"D:\\Program Files (x86)\\ys\\project\\springboot\\测盟汇系统\\frontend\\src\\views\\MeetingManage.vue","mtime":1750597801810},{"path":"D:\\Program Files (x86)\\ys\\project\\springboot\\测盟汇系统\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":1750527325917},{"path":"D:\\Program Files (x86)\\ys\\project\\springboot\\测盟汇系统\\frontend\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1750527325076},{"path":"D:\\Program Files (x86)\\ys\\project\\springboot\\测盟汇系统\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1750527325628},{"path":"D:\\Program Files (x86)\\ys\\project\\springboot\\测盟汇系统\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1750527324930},{"path":"D:\\Program Files (x86)\\ys\\project\\springboot\\测盟汇系统\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1750527325038}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouY2FyZC1oZWFkZXIgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi5zZWFyY2gtYmFyIHsNCiAgbWFyZ2luLWJvdHRvbTogMjBweDsNCn0NCg0KLnNlYXJjaC1iYXIgLmVsLXJvdyB7DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQp9DQoNCi5wYWdpbmF0aW9uIHsNCiAgbWFyZ2luLXRvcDogMjBweDsNCiAgdGV4dC1hbGlnbjogcmlnaHQ7DQp9DQoNCi5lbXB0eS1kYXRhIHsNCiAgcGFkZGluZzogNDBweCAwOw0KfQ0K"},{"version":3,"sources":["D:\\Program Files (x86)\\ys\\project\\springboot\\测盟汇系统\\frontend\\src\\views\\MeetingManage.vue"],"names":[],"mappings":";AA6kBA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC9B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACrB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACrB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACrB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;AACnB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;AACjB","file":"D:/Program Files (x86)/ys/project/springboot/测盟汇系统/frontend/src/views/MeetingManage.vue","sourceRoot":"","sourcesContent":["<template>\r\n  <div class=\"meeting-manage\">\r\n    <el-card>\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>会议管理</span>\r\n          <div>\r\n            <el-button type=\"success\" @click=\"exportMeetings\">导出会议</el-button>\r\n            <el-button type=\"primary\" @click=\"showAddDialog = true\">创建会议</el-button>\r\n          </div>\r\n        </div>\r\n      </template>\r\n\r\n      <div class=\"search-bar\">\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"8\">\r\n            <el-input\r\n              v-model=\"searchKeyword\"\r\n              placeholder=\"请输入会议名称或创建人\"\r\n              clearable\r\n              @keyup.enter=\"loadMeetings\"\r\n            >\r\n              <template #append>\r\n                <el-button @click=\"loadMeetings\">搜索</el-button>\r\n              </template>\r\n            </el-input>\r\n          </el-col>\r\n          <el-col :span=\"4\">\r\n            <el-select v-model=\"statusFilter\" placeholder=\"状态筛选\" style=\"width: 100%\" @change=\"loadMeetings\">\r\n              <el-option label=\"全部\" value=\"\" />\r\n              <el-option label=\"待审核\" value=\"0\" />\r\n              <el-option label=\"已发布\" value=\"1\" />\r\n              <el-option label=\"已拒绝\" value=\"2\" />\r\n            </el-select>\r\n          </el-col>\r\n          <el-col :span=\"6\">\r\n            <el-date-picker\r\n              v-model=\"createTimeRange\"\r\n              type=\"daterange\"\r\n              range-separator=\"至\"\r\n              start-placeholder=\"开始日期\"\r\n              end-placeholder=\"结束日期\"\r\n              format=\"YYYY-MM-DD\"\r\n              value-format=\"YYYY-MM-DD\"\r\n              style=\"width: 100%\"\r\n              @change=\"loadMeetings\"\r\n            />\r\n          </el-col>\r\n          <el-col :span=\"6\">\r\n            <el-button @click=\"resetFilters\" style=\"margin-right: 10px\">重置</el-button>\r\n            <el-button type=\"primary\" @click=\"openNotifyDialog\" v-if=\"isAdmin\">发布通知</el-button>\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n\r\n      <el-table :data=\"meetingList\" style=\"width: 100%\" v-loading=\"loading\">\r\n        <template #empty>\r\n          <div class=\"empty-data\">\r\n            <el-empty description=\"暂无会议数据\" />\r\n          </div>\r\n        </template>\r\n        <el-table-column prop=\"meetingName\" label=\"会议名称\" width=\"180\" show-overflow-tooltip />\r\n        <el-table-column label=\"封面\" width=\"80\">\r\n          <template #default=\"scope\">\r\n            <img v-if=\"scope.row.coverImage\" :src=\"getImageUrl(scope.row.coverImage)\" style=\"width: 50px; height: 30px; object-fit: cover;\" />\r\n            <span v-else>无</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"meetingTime\" label=\"会议时间\" width=\"160\" />\r\n        <el-table-column prop=\"location\" label=\"会议地点\" width=\"150\" />\r\n        <el-table-column prop=\"organizer\" label=\"主办单位\" width=\"120\" />\r\n        <el-table-column prop=\"category\" label=\"会议分类\" width=\"120\" />\r\n        <el-table-column prop=\"creator\" label=\"创建人\" width=\"100\" />\r\n        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\r\n          <template #default=\"scope\">\r\n            <el-tag :type=\"getStatusType(scope.row.status)\">\r\n              {{ getStatusText(scope.row.status) }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"createTime\" label=\"创建时间\" width=\"180\" />\r\n        <el-table-column label=\"操作\" width=\"250\">\r\n          <template #default=\"scope\">\r\n            <el-button \r\n              size=\"small\" \r\n              @click=\"editMeeting(scope.row)\" \r\n              v-if=\"canEdit(scope.row)\"\r\n            >\r\n              编辑\r\n            </el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"primary\" \r\n              @click=\"auditMeeting(scope.row)\" \r\n              v-if=\"canAudit(scope.row)\"\r\n            >\r\n              审核\r\n            </el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"danger\" \r\n              @click=\"deleteMeeting(scope.row)\" \r\n              v-if=\"canDelete(scope.row)\"\r\n            >\r\n              删除\r\n            </el-button>\r\n            <span v-if=\"!canEdit(scope.row) && !canAudit(scope.row) && !canDelete(scope.row)\" style=\"color: #999;\">\r\n              无操作权限\r\n            </span>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <div class=\"pagination\">\r\n        <el-pagination\r\n          v-model:current-page=\"currentPage\"\r\n          v-model:page-size=\"pageSize\"\r\n          :total=\"total\"\r\n          layout=\"total, sizes, prev, pager, next\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          @current-change=\"loadMeetings\"\r\n          @size-change=\"handleSizeChange\"\r\n        />\r\n      </div>\r\n    </el-card>\r\n\r\n    <!-- 创建/编辑会议对话框 -->\r\n    <el-dialog v-model=\"showAddDialog\" :title=\"editingMeeting ? '编辑会议' : '创建会议'\" width=\"600px\">\r\n      <el-form :model=\"meetingForm\" ref=\"meetingFormRef\" label-width=\"100px\">\r\n        <el-form-item label=\"会议名称\">\r\n          <el-input v-model=\"meetingForm.meetingName\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"会议时间\">\r\n          <el-date-picker\r\n            v-model=\"meetingForm.meetingTime\"\r\n            type=\"datetime\"\r\n            placeholder=\"选择会议时间\"\r\n            style=\"width: 100%\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"会议地点\">\r\n          <el-input v-model=\"meetingForm.location\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"主办单位\">\r\n          <el-input v-model=\"meetingForm.organizer\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"会议分类\">\r\n          <el-select v-model=\"meetingForm.category\" style=\"width: 100%\">\r\n            <el-option label=\"研讨\" value=\"研讨\" />\r\n            <el-option label=\"标准定制\" value=\"标准定制\" />\r\n            <el-option label=\"技术培训\" value=\"技术培训\" />\r\n            <el-option label=\"工具研发\" value=\"工具研发\" />\r\n            <el-option label=\"公益行动\" value=\"公益行动\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"会议内容\">\r\n          <el-input v-model=\"meetingForm.meetingContent\" type=\"textarea\" :rows=\"6\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"会议封面\">\r\n          <el-upload\r\n            class=\"upload-demo\"\r\n            :action=\"uploadUrl\"\r\n            :show-file-list=\"false\"\r\n            :on-success=\"handleCoverSuccess\"\r\n            :before-upload=\"beforeUpload\"\r\n          >\r\n            <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n          </el-upload>\r\n          <div v-if=\"meetingForm.coverImage\" style=\"margin-top: 10px;\">\r\n            <img :src=\"getImageUrl(meetingForm.coverImage)\" style=\"width: 100px; height: 60px; object-fit: cover;\" />\r\n            <el-button size=\"small\" type=\"danger\" @click=\"meetingForm.coverImage = ''\" style=\"margin-left: 10px;\">删除</el-button>\r\n          </div>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <el-button @click=\"showAddDialog = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveMeeting\">保存</el-button>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 审核对话框 -->\r\n    <el-dialog v-model=\"showAuditDialog\" title=\"审核会议\" width=\"400px\">\r\n      <div style=\"margin-bottom: 20px;\">\r\n        <strong>会议名称：</strong>{{ auditingMeeting && auditingMeeting.meetingName }}\r\n      </div>\r\n      <el-radio-group v-model=\"auditStatus\">\r\n        <el-radio :label=\"1\">通过</el-radio>\r\n        <el-radio :label=\"2\">拒绝</el-radio>\r\n      </el-radio-group>\r\n      <template #footer>\r\n        <el-button @click=\"showAuditDialog = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"submitAudit\">确定</el-button>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 发布通知对话框 -->\r\n    <el-dialog v-model=\"showNotifyDialog\" title=\"发布会议通知\" width=\"600px\">\r\n      <el-form :model=\"notifyForm\" ref=\"notifyFormRef\" label-width=\"100px\">\r\n        <el-form-item label=\"通知标题\" required>\r\n          <el-input v-model=\"notifyForm.title\" placeholder=\"请输入通知标题\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"通知内容\" required>\r\n          <el-input \r\n            v-model=\"notifyForm.content\" \r\n            type=\"textarea\" \r\n            :rows=\"8\"\r\n            placeholder=\"请输入通知内容\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"关联会议\">\r\n          <el-select v-model=\"notifyForm.meetingId\" placeholder=\"选择关联会议（可选）\" style=\"width: 100%\">\r\n            <el-option \r\n              v-for=\"meeting in publishedMeetings\" \r\n              :key=\"meeting.id\" \r\n              :label=\"meeting.meetingName\" \r\n              :value=\"meeting.id\" \r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <el-button @click=\"showNotifyDialog = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"publishNotify\">发布</el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, computed } from 'vue'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport request from '../utils/request'\r\n\r\nconst meetingList = ref([])\r\nconst loading = ref(false)\r\nconst showAddDialog = ref(false)\r\nconst showAuditDialog = ref(false)\r\nconst showNotifyDialog = ref(false)\r\nconst editingMeeting = ref(null)\r\nconst auditingMeeting = ref(null)\r\nconst searchKeyword = ref('')\r\nconst statusFilter = ref('')\r\nconst createTimeRange = ref([])\r\nconst currentPage = ref(1)\r\nconst pageSize = ref(10)\r\nconst total = ref(0)\r\nconst uploadUrl = ref('/api/file/upload')\r\nconst auditStatus = ref(1)\r\nconst publishedMeetings = ref([])\r\n\r\nconst user = computed(() => {\r\n  const userStr = localStorage.getItem('user')\r\n  return userStr ? JSON.parse(userStr) : {}\r\n})\r\n\r\nconst isAdmin = computed(() => {\r\n  return user.value.role === 'ADMIN'\r\n})\r\n\r\nconst meetingForm = reactive({\r\n  meetingName: '',\r\n  meetingTime: '',\r\n  location: '',\r\n  organizer: '',\r\n  category: '',\r\n  meetingContent: '',\r\n  coverImage: ''\r\n})\r\n\r\nconst notifyForm = reactive({\r\n  title: '',\r\n  content: '',\r\n  meetingId: null\r\n})\r\n\r\nconst meetingFormRef = ref()\r\n\r\nonMounted(() => {\r\n  loadMeetings()\r\n  loadPublishedMeetings()\r\n})\r\n\r\nconst loadMeetings = async () => {\r\n  loading.value = true\r\n  try {\r\n    const params = {\r\n      current: currentPage.value,\r\n      size: pageSize.value,\r\n      keyword: searchKeyword.value\r\n    }\r\n    \r\n    // 添加状态筛选\r\n    if (statusFilter.value !== '') {\r\n      params.status = statusFilter.value\r\n    }\r\n    \r\n    // 添加创建时间筛选\r\n    if (createTimeRange.value && createTimeRange.value.length === 2) {\r\n      // 确保日期格式正确\r\n      const startDate = createTimeRange.value[0]\r\n      const endDate = createTimeRange.value[1]\r\n      \r\n      if (startDate instanceof Date) {\r\n        params.startDate = startDate.toISOString().split('T')[0]\r\n      } else {\r\n        params.startDate = startDate\r\n      }\r\n      \r\n      if (endDate instanceof Date) {\r\n        params.endDate = endDate.toISOString().split('T')[0]\r\n      } else {\r\n        params.endDate = endDate\r\n      }\r\n    }\r\n    \r\n    const res = await request.get('/meeting/page', { params })\r\n    meetingList.value = res.data.records || []\r\n    total.value = res.data.total || 0\r\n  } catch (error) {\r\n    console.error('加载会议列表失败:', error)\r\n    meetingList.value = []\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst getStatusType = (status) => {\r\n  const types = { 0: 'warning', 1: 'success', 2: 'danger' }\r\n  return types[status] || 'info'\r\n}\r\n\r\nconst getStatusText = (status) => {\r\n  const texts = { 0: '待审核', 1: '已发布', 2: '已拒绝' }\r\n  return texts[status] || '未知'\r\n}\r\n\r\nconst editMeeting = (meeting) => {\r\n  editingMeeting.value = meeting\r\n  Object.assign(meetingForm, meeting)\r\n  showAddDialog.value = true\r\n}\r\n\r\nconst saveMeeting = async () => {\r\n  try {\r\n    const formData = { ...meetingForm }\r\n    \r\n    // 格式化会议时间\r\n    if (formData.meetingTime) {\r\n      if (formData.meetingTime instanceof Date) {\r\n        formData.meetingTime = formData.meetingTime.toISOString().slice(0, 19).replace('T', ' ')\r\n      }\r\n    }\r\n    \r\n    if (editingMeeting.value) {\r\n      await request.put(`/meeting/${editingMeeting.value.id}`, formData)\r\n      ElMessage.success('更新成功')\r\n    } else {\r\n      await request.post('/meeting', formData)\r\n      ElMessage.success('创建成功')\r\n    }\r\n    showAddDialog.value = false\r\n    resetForm()\r\n    loadMeetings()\r\n  } catch (error) {\r\n    console.error('保存会议失败:', error)\r\n  }\r\n}\r\n\r\nconst deleteMeeting = async (meeting) => {\r\n  try {\r\n    await ElMessageBox.confirm('确定要删除这个会议吗？', '提示')\r\n    await request.delete(`/meeting/${meeting.id}`)\r\n    ElMessage.success('删除成功')\r\n    loadMeetings()\r\n  } catch (error) {\r\n    if (error !== 'cancel') {\r\n      console.error('删除会议失败:', error)\r\n    }\r\n  }\r\n}\r\n\r\nconst resetForm = () => {\r\n  editingMeeting.value = null\r\n  Object.assign(meetingForm, {\r\n    meetingName: '',\r\n    meetingTime: '',\r\n    location: '',\r\n    organizer: '',\r\n    category: '',\r\n    meetingContent: '',\r\n    coverImage: ''\r\n  })\r\n}\r\n\r\nconst handleCoverSuccess = (response) => {\r\n  if (response.code === 200) {\r\n    meetingForm.coverImage = response.data\r\n    ElMessage.success('封面上传成功')\r\n  } else {\r\n    ElMessage.error('封面上传失败')\r\n  }\r\n}\r\n\r\nconst beforeUpload = (file) => {\r\n  const isImage = file.type.indexOf('image/') === 0\r\n  const isLt2M = file.size / 1024 / 1024 < 2\r\n\r\n  if (!isImage) {\r\n    ElMessage.error('只能上传图片文件!')\r\n    return false\r\n  }\r\n  if (!isLt2M) {\r\n    ElMessage.error('图片大小不能超过 2MB!')\r\n    return false\r\n  }\r\n  return true\r\n}\r\n\r\nconst canEdit = (meeting) => {\r\n  // 只有管理员或创建者本人可以编辑\r\n  if (!user.value || !user.value.id || !meeting) {\r\n    return false\r\n  }\r\n  \r\n  // 管理员可以编辑所有会议\r\n  if (user.value.role === 'ADMIN') {\r\n    return true\r\n  }\r\n  \r\n  // 创建者本人可以编辑自己的会议\r\n  return meeting.creatorId === user.value.id\r\n}\r\n\r\nconst canDelete = (meeting) => {\r\n  // 只有管理员或创建者本人可以删除\r\n  if (!user.value || !user.value.id || !meeting) {\r\n    return false\r\n  }\r\n  \r\n  // 管理员可以删除所有会议\r\n  if (user.value.role === 'ADMIN') {\r\n    return true\r\n  }\r\n  \r\n  // 创建者本人可以删除自己的会议\r\n  return meeting.creatorId === user.value.id\r\n}\r\n\r\nconst canAudit = (meeting) => {\r\n  return user.value.role === 'ADMIN' && meeting.status === 0\r\n}\r\n\r\nconst auditMeeting = (meeting) => {\r\n  auditingMeeting.value = meeting\r\n  auditStatus.value = 1\r\n  showAuditDialog.value = true\r\n}\r\n\r\nconst submitAudit = async () => {\r\n  try {\r\n    await request.post(`/meeting/${auditingMeeting.value.id}/audit?status=${auditStatus.value}`)\r\n    ElMessage.success('审核成功')\r\n    showAuditDialog.value = false\r\n    loadMeetings()\r\n  } catch (error) {\r\n    console.error('审核失败:', error)\r\n  }\r\n}\r\n\r\nconst getImageUrl = (imagePath) => {\r\n  if (!imagePath) return ''\r\n  if (imagePath.startsWith('http')) return imagePath\r\n  return `http://localhost:8080/api${imagePath}`\r\n}\r\n\r\nconst exportMeetings = async () => {\r\n  try {\r\n    const res = await request.get('/meeting/export', {\r\n      params: {\r\n        keyword: searchKeyword.value\r\n      },\r\n      responseType: 'blob'\r\n    })\r\n    \r\n    const blob = new Blob([res], { type: 'text/csv;charset=utf-8' })\r\n    const url = window.URL.createObjectURL(blob)\r\n    const a = document.createElement('a')\r\n    a.href = url\r\n    a.download = `meetings_${new Date().toISOString().split('T')[0]}.csv`\r\n    document.body.appendChild(a)\r\n    a.click()\r\n    document.body.removeChild(a)\r\n    window.URL.revokeObjectURL(url)\r\n    \r\n    ElMessage.success('导出成功')\r\n  } catch (error) {\r\n    console.error('导出失败:', error)\r\n    ElMessage.error('导出失败')\r\n  }\r\n}\r\n\r\nconst handleSizeChange = (size) => {\r\n  pageSize.value = size\r\n  currentPage.value = 1\r\n  loadMeetings()\r\n}\r\n\r\n// 重置筛选条件\r\nconst resetFilters = () => {\r\n  searchKeyword.value = ''\r\n  statusFilter.value = ''\r\n  createTimeRange.value = []\r\n  currentPage.value = 1\r\n  loadMeetings()\r\n}\r\n\r\n// 加载已发布的会议列表\r\nconst loadPublishedMeetings = async () => {\r\n  try {\r\n    const res = await request.get('/meeting/page', {\r\n      params: {\r\n        current: 1,\r\n        size: 100,\r\n        status: 1\r\n      }\r\n    })\r\n    publishedMeetings.value = res.data.records || []\r\n  } catch (error) {\r\n    console.error('加载已发布会议列表失败:', error)\r\n  }\r\n}\r\n\r\n// 发布通知\r\nconst publishNotify = async () => {\r\n  if (!notifyForm.title.trim()) {\r\n    ElMessage.error('请输入通知标题')\r\n    return\r\n  }\r\n  if (!notifyForm.content.trim()) {\r\n    ElMessage.error('请输入通知内容')\r\n    return\r\n  }\r\n  \r\n  try {\r\n    // 如果选择了关联会议，在标题和内容中体现\r\n    let title = notifyForm.title\r\n    let content = notifyForm.content\r\n    \r\n    if (notifyForm.meetingId) {\r\n      const selectedMeeting = publishedMeetings.value.find(m => m.id === notifyForm.meetingId)\r\n      if (selectedMeeting) {\r\n        title = `【会议通知】${notifyForm.title}`\r\n        content = `关于\"${selectedMeeting.meetingName}\"会议的通知：\\n\\n${notifyForm.content}`\r\n      }\r\n    } else {\r\n      title = `【会议通知】${notifyForm.title}`\r\n    }\r\n    \r\n    await request.post('/news', {\r\n      title: title,\r\n      content: content,\r\n      summary: content.substring(0, 200) + (content.length > 200 ? '...' : ''),\r\n      category: '会议通知',\r\n      status: 1\r\n    })\r\n    ElMessage.success('通知发布成功')\r\n    showNotifyDialog.value = false\r\n    resetNotifyForm()\r\n  } catch (error) {\r\n    console.error('发布通知失败:', error)\r\n    ElMessage.error('发布通知失败')\r\n  }\r\n}\r\n\r\n// 打开通知对话框\r\nconst openNotifyDialog = () => {\r\n  resetNotifyForm()\r\n  showNotifyDialog.value = true\r\n}\r\n\r\n// 重置通知表单\r\nconst resetNotifyForm = () => {\r\n  notifyForm.title = ''\r\n  notifyForm.content = ''\r\n  notifyForm.meetingId = null\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.search-bar {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.search-bar .el-row {\r\n  align-items: center;\r\n}\r\n\r\n.pagination {\r\n  margin-top: 20px;\r\n  text-align: right;\r\n}\r\n\r\n.empty-data {\r\n  padding: 40px 0;\r\n}\r\n</style> "]}]}