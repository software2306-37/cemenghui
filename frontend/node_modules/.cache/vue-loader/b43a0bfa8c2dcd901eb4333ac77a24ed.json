{"remainingRequest":"E:\\Idea works\\GithubUploadFild\\cemenghui\\frontend\\cemenghui\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!E:\\Idea works\\GithubUploadFild\\cemenghui\\frontend\\cemenghui\\frontend\\src\\views\\MeetingManage.vue?vue&type=style&index=0&id=a918f894&scoped=true&lang=css","dependencies":[{"path":"E:\\Idea works\\GithubUploadFild\\cemenghui\\frontend\\cemenghui\\frontend\\src\\views\\MeetingManage.vue","mtime":1752137225628},{"path":"E:\\Idea works\\GithubUploadFild\\cemenghui\\frontend\\cemenghui\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":1752137215822},{"path":"E:\\Idea works\\GithubUploadFild\\cemenghui\\frontend\\cemenghui\\frontend\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1752137225080},{"path":"E:\\Idea works\\GithubUploadFild\\cemenghui\\frontend\\cemenghui\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1752137223127},{"path":"E:\\Idea works\\GithubUploadFild\\cemenghui\\frontend\\cemenghui\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1752137215170},{"path":"E:\\Idea works\\GithubUploadFild\\cemenghui\\frontend\\cemenghui\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1752137225072}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoJLmNhcmQtaGVhZGVyIHsNCgkgIGRpc3BsYXk6IGZsZXg7DQoJICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQoJICBhbGlnbi1pdGVtczogY2VudGVyOw0KCX0NCgkNCgkuc2VhcmNoLWJhciB7DQoJICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KCX0NCgkNCgkuc2VhcmNoLWJhciAuZWwtcm93IHsNCgkgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQoJfQ0KCQ0KCS5wYWdpbmF0aW9uIHsNCgkgIG1hcmdpbi10b3A6IDIwcHg7DQoJICB0ZXh0LWFsaWduOiByaWdodDsNCgl9DQoJDQoJLmVtcHR5LWRhdGEgew0KCSAgcGFkZGluZzogNDBweCAwOw0KCX0NCg=="},{"version":3,"sources":["E:\\Idea works\\GithubUploadFild\\cemenghui\\frontend\\cemenghui\\frontend\\src\\views\\MeetingManage.vue"],"names":[],"mappings":";CA6kBC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;GACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;GACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;GAC9B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;CACrB;;CAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;GACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;CACrB;;CAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;GAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;CACrB;;CAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;GACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;GAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;CACnB;;CAEA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;GACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;CACjB","file":"E:/Idea works/GithubUploadFild/cemenghui/frontend/cemenghui/frontend/src/views/MeetingManage.vue","sourceRoot":"","sourcesContent":["<template>\r\n\t <div class=\"meeting-manage\">\r\n\t    <el-card>\r\n\t      <template #header>\r\n\t        <div class=\"card-header\">\r\n\t          <span>会议管理</span>\r\n\t          <div>\r\n\t            <el-button type=\"success\" @click=\"exportMeetings\">导出会议</el-button>\r\n\t            <el-button type=\"primary\" @click=\"showAddDialog = true\">创建会议</el-button>\r\n\t          </div>\r\n\t        </div>\r\n\t      </template>\r\n\t\r\n\t      <div class=\"search-bar\">\r\n\t        <el-row :gutter=\"20\">\r\n\t          <el-col :span=\"8\">\r\n\t            <el-input\r\n\t              v-model=\"searchKeyword\"\r\n\t              placeholder=\"请输入会议名称或创建人\"\r\n\t              clearable\r\n\t              @keyup.enter=\"loadMeetings\"\r\n\t            >\r\n\t              <template #append>\r\n\t                <el-button @click=\"loadMeetings\">搜索</el-button>\r\n\t              </template>\r\n\t            </el-input>\r\n\t          </el-col>\r\n\t          <el-col :span=\"4\">\r\n\t            <el-select v-model=\"statusFilter\" placeholder=\"状态筛选\" style=\"width: 100%\" @change=\"loadMeetings\">\r\n\t              <el-option label=\"全部\" value=\"\" />\r\n\t              <el-option label=\"待审核\" value=\"0\" />\r\n\t              <el-option label=\"已发布\" value=\"1\" />\r\n\t              <el-option label=\"已拒绝\" value=\"2\" />\r\n\t            </el-select>\r\n\t          </el-col>\r\n\t          <el-col :span=\"6\">\r\n\t            <el-date-picker\r\n\t              v-model=\"createTimeRange\"\r\n\t              type=\"daterange\"\r\n\t              range-separator=\"至\"\r\n\t              start-placeholder=\"开始日期\"\r\n\t              end-placeholder=\"结束日期\"\r\n\t              format=\"YYYY-MM-DD\"\r\n\t              value-format=\"YYYY-MM-DD\"\r\n\t              style=\"width: 100%\"\r\n\t              @change=\"loadMeetings\"\r\n\t            />\r\n\t          </el-col>\r\n\t          <el-col :span=\"6\">\r\n\t            <el-button @click=\"resetFilters\" style=\"margin-right: 10px\">重置</el-button>\r\n\t            <el-button type=\"primary\" @click=\"openNotifyDialog\" v-if=\"isAdmin\">发布通知</el-button>\r\n\t          </el-col>\r\n\t        </el-row>\r\n\t      </div>\r\n\t\r\n\t      <el-table :data=\"meetingList\" style=\"width: 100%\" v-loading=\"loading\">\r\n\t        <template #empty>\r\n\t          <div class=\"empty-data\">\r\n\t            <el-empty description=\"暂无会议数据\" />\r\n\t          </div>\r\n\t        </template>\r\n\t        <el-table-column prop=\"meetingName\" label=\"会议名称\" width=\"180\" show-overflow-tooltip />\r\n\t        <el-table-column label=\"封面\" width=\"80\">\r\n\t          <template #default=\"scope\">\r\n\t            <img v-if=\"scope.row.coverImage\" :src=\"getImageUrl(scope.row.coverImage)\" style=\"width: 50px; height: 30px; object-fit: cover;\" />\r\n\t            <span v-else>无</span>\r\n\t          </template>\r\n\t        </el-table-column>\r\n\t        <el-table-column prop=\"meetingTime\" label=\"会议时间\" width=\"160\" />\r\n\t        <el-table-column prop=\"location\" label=\"会议地点\" width=\"150\" />\r\n\t        <el-table-column prop=\"organizer\" label=\"主办单位\" width=\"120\" />\r\n\t        <el-table-column prop=\"category\" label=\"会议分类\" width=\"120\" />\r\n\t        <el-table-column prop=\"creator\" label=\"创建人\" width=\"100\" />\r\n\t        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\r\n\t          <template #default=\"scope\">\r\n\t            <el-tag :type=\"getStatusType(scope.row.status)\">\r\n\t              {{ getStatusText(scope.row.status) }}\r\n\t            </el-tag>\r\n\t          </template>\r\n\t        </el-table-column>\r\n\t        <el-table-column prop=\"createTime\" label=\"创建时间\" width=\"180\" />\r\n\t        <el-table-column label=\"操作\" width=\"250\">\r\n\t          <template #default=\"scope\">\r\n\t            <el-button \r\n\t              size=\"small\" \r\n\t              @click=\"editMeeting(scope.row)\" \r\n\t              v-if=\"canEdit(scope.row)\"\r\n\t            >\r\n\t              编辑\r\n\t            </el-button>\r\n\t            <el-button \r\n\t              size=\"small\" \r\n\t              type=\"primary\" \r\n\t              @click=\"auditMeeting(scope.row)\" \r\n\t              v-if=\"canAudit(scope.row)\"\r\n\t            >\r\n\t              审核\r\n\t            </el-button>\r\n\t            <el-button \r\n\t              size=\"small\" \r\n\t              type=\"danger\" \r\n\t              @click=\"deleteMeeting(scope.row)\" \r\n\t              v-if=\"canDelete(scope.row)\"\r\n\t            >\r\n\t              删除\r\n\t            </el-button>\r\n\t            <span v-if=\"!canEdit(scope.row) && !canAudit(scope.row) && !canDelete(scope.row)\" style=\"color: #999;\">\r\n\t              无操作权限\r\n\t            </span>\r\n\t          </template>\r\n\t        </el-table-column>\r\n\t      </el-table>\r\n\t\r\n\t      <div class=\"pagination\">\r\n\t        <el-pagination\r\n\t          v-model:current-page=\"currentPage\"\r\n\t          v-model:page-size=\"pageSize\"\r\n\t          :total=\"total\"\r\n\t          layout=\"total, sizes, prev, pager, next\"\r\n\t          :page-sizes=\"[10, 20, 50, 100]\"\r\n\t          @current-change=\"loadMeetings\"\r\n\t          @size-change=\"handleSizeChange\"\r\n\t        />\r\n\t      </div>\r\n\t    </el-card>\r\n\t\r\n\t    <!-- 创建/编辑会议对话框 -->\r\n\t    <el-dialog v-model=\"showAddDialog\" :title=\"editingMeeting ? '编辑会议' : '创建会议'\" width=\"600px\">\r\n\t      <el-form :model=\"meetingForm\" ref=\"meetingFormRef\" label-width=\"100px\">\r\n\t        <el-form-item label=\"会议名称\">\r\n\t          <el-input v-model=\"meetingForm.meetingName\" />\r\n\t        </el-form-item>\r\n\t        <el-form-item label=\"会议时间\">\r\n\t          <el-date-picker\r\n\t            v-model=\"meetingForm.meetingTime\"\r\n\t            type=\"datetime\"\r\n\t            placeholder=\"选择会议时间\"\r\n\t            style=\"width: 100%\"\r\n\t          />\r\n\t        </el-form-item>\r\n\t        <el-form-item label=\"会议地点\">\r\n\t          <el-input v-model=\"meetingForm.location\" />\r\n\t        </el-form-item>\r\n\t        <el-form-item label=\"主办单位\">\r\n\t          <el-input v-model=\"meetingForm.organizer\" />\r\n\t        </el-form-item>\r\n\t        <el-form-item label=\"会议分类\">\r\n\t          <el-select v-model=\"meetingForm.category\" style=\"width: 100%\">\r\n\t            <el-option label=\"研讨\" value=\"研讨\" />\r\n\t            <el-option label=\"标准定制\" value=\"标准定制\" />\r\n\t            <el-option label=\"技术培训\" value=\"技术培训\" />\r\n\t            <el-option label=\"工具研发\" value=\"工具研发\" />\r\n\t            <el-option label=\"公益行动\" value=\"公益行动\" />\r\n\t          </el-select>\r\n\t        </el-form-item>\r\n\t        <el-form-item label=\"会议内容\">\r\n\t          <el-input v-model=\"meetingForm.meetingContent\" type=\"textarea\" :rows=\"6\" />\r\n\t        </el-form-item>\r\n\t        <el-form-item label=\"会议封面\">\r\n\t          <el-upload\r\n\t            class=\"upload-demo\"\r\n\t            :action=\"uploadUrl\"\r\n\t            :show-file-list=\"false\"\r\n\t            :on-success=\"handleCoverSuccess\"\r\n\t            :before-upload=\"beforeUpload\"\r\n\t          >\r\n\t            <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n\t          </el-upload>\r\n\t          <div v-if=\"meetingForm.coverImage\" style=\"margin-top: 10px;\">\r\n\t            <img :src=\"getImageUrl(meetingForm.coverImage)\" style=\"width: 100px; height: 60px; object-fit: cover;\" />\r\n\t            <el-button size=\"small\" type=\"danger\" @click=\"meetingForm.coverImage = ''\" style=\"margin-left: 10px;\">删除</el-button>\r\n\t          </div>\r\n\t        </el-form-item>\r\n\t      </el-form>\r\n\t      <template #footer>\r\n\t        <el-button @click=\"showAddDialog = false\">取消</el-button>\r\n\t        <el-button type=\"primary\" @click=\"saveMeeting\">保存</el-button>\r\n\t      </template>\r\n\t    </el-dialog>\r\n\t\r\n\t    <!-- 审核对话框 -->\r\n\t    <el-dialog v-model=\"showAuditDialog\" title=\"审核会议\" width=\"400px\">\r\n\t      <div style=\"margin-bottom: 20px;\">\r\n\t        <strong>会议名称：</strong>{{ auditingMeeting && auditingMeeting.meetingName }}\r\n\t      </div>\r\n\t      <el-radio-group v-model=\"auditStatus\">\r\n\t        <el-radio :label=\"1\">通过</el-radio>\r\n\t        <el-radio :label=\"2\">拒绝</el-radio>\r\n\t      </el-radio-group>\r\n\t      <template #footer>\r\n\t        <el-button @click=\"showAuditDialog = false\">取消</el-button>\r\n\t        <el-button type=\"primary\" @click=\"submitAudit\">确定</el-button>\r\n\t      </template>\r\n\t    </el-dialog>\r\n\t\r\n\t    <!-- 发布通知对话框 -->\r\n\t    <el-dialog v-model=\"showNotifyDialog\" title=\"发布会议通知\" width=\"600px\">\r\n\t      <el-form :model=\"notifyForm\" ref=\"notifyFormRef\" label-width=\"100px\">\r\n\t        <el-form-item label=\"通知标题\" required>\r\n\t          <el-input v-model=\"notifyForm.title\" placeholder=\"请输入通知标题\" />\r\n\t        </el-form-item>\r\n\t        <el-form-item label=\"通知内容\" required>\r\n\t          <el-input \r\n\t            v-model=\"notifyForm.content\" \r\n\t            type=\"textarea\" \r\n\t            :rows=\"8\"\r\n\t            placeholder=\"请输入通知内容\"\r\n\t          />\r\n\t        </el-form-item>\r\n\t        <el-form-item label=\"关联会议\">\r\n\t          <el-select v-model=\"notifyForm.meetingId\" placeholder=\"选择关联会议（可选）\" style=\"width: 100%\">\r\n\t            <el-option \r\n\t              v-for=\"meeting in publishedMeetings\" \r\n\t              :key=\"meeting.id\" \r\n\t              :label=\"meeting.meetingName\" \r\n\t              :value=\"meeting.id\" \r\n\t            />\r\n\t          </el-select>\r\n\t        </el-form-item>\r\n\t      </el-form>\r\n\t      <template #footer>\r\n\t        <el-button @click=\"showNotifyDialog = false\">取消</el-button>\r\n\t        <el-button type=\"primary\" @click=\"publishNotify\">发布</el-button>\r\n\t      </template>\r\n\t    </el-dialog>\r\n\t  </div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { ref, reactive, onMounted, computed } from 'vue'\r\n\timport { ElMessage, ElMessageBox } from 'element-plus'\r\n\timport request from '../utils/request'\r\n\t\r\n\tconst meetingList = ref([])\r\n\tconst loading = ref(false)\r\n\tconst showAddDialog = ref(false)\r\n\tconst showAuditDialog = ref(false)\r\n\tconst showNotifyDialog = ref(false)\r\n\tconst editingMeeting = ref(null)\r\n\tconst auditingMeeting = ref(null)\r\n\tconst searchKeyword = ref('')\r\n\tconst statusFilter = ref('')\r\n\tconst createTimeRange = ref([])\r\n\tconst currentPage = ref(1)\r\n\tconst pageSize = ref(10)\r\n\tconst total = ref(0)\r\n\tconst uploadUrl = ref('/api/file/upload')\r\n\tconst auditStatus = ref(1)\r\n\tconst publishedMeetings = ref([])\r\n\t\r\n\tconst user = computed(() => {\r\n\t  const userStr = localStorage.getItem('user')\r\n\t  return userStr ? JSON.parse(userStr) : {}\r\n\t})\r\n\t\r\n\tconst isAdmin = computed(() => {\r\n\t  return user.value.role === 'ADMIN'\r\n\t})\r\n\t\r\n\tconst meetingForm = reactive({\r\n\t  meetingName: '',\r\n\t  meetingTime: '',\r\n\t  location: '',\r\n\t  organizer: '',\r\n\t  category: '',\r\n\t  meetingContent: '',\r\n\t  coverImage: ''\r\n\t})\r\n\t\r\n\tconst notifyForm = reactive({\r\n\t  title: '',\r\n\t  content: '',\r\n\t  meetingId: null\r\n\t})\r\n\t\r\n\tconst meetingFormRef = ref()\r\n\t\r\n\tonMounted(() => {\r\n\t  loadMeetings()\r\n\t  loadPublishedMeetings()\r\n\t})\r\n\t\r\n\tconst loadMeetings = async () => {\r\n\t  loading.value = true\r\n\t  try {\r\n\t    const params = {\r\n\t      current: currentPage.value,\r\n\t      size: pageSize.value,\r\n\t      keyword: searchKeyword.value\r\n\t    }\r\n\t    \r\n\t    // 添加状态筛选\r\n\t    if (statusFilter.value !== '') {\r\n\t      params.status = statusFilter.value\r\n\t    }\r\n\t    \r\n\t    // 添加创建时间筛选\r\n\t    if (createTimeRange.value && createTimeRange.value.length === 2) {\r\n\t      // 确保日期格式正确\r\n\t      const startDate = createTimeRange.value[0]\r\n\t      const endDate = createTimeRange.value[1]\r\n\t      \r\n\t      if (startDate instanceof Date) {\r\n\t        params.startDate = startDate.toISOString().split('T')[0]\r\n\t      } else {\r\n\t        params.startDate = startDate\r\n\t      }\r\n\t      \r\n\t      if (endDate instanceof Date) {\r\n\t        params.endDate = endDate.toISOString().split('T')[0]\r\n\t      } else {\r\n\t        params.endDate = endDate\r\n\t      }\r\n\t    }\r\n\t    \r\n\t    const res = await request.get('/meeting/page', { params })\r\n\t    meetingList.value = res.data.records || []\r\n\t    total.value = res.data.total || 0\r\n\t  } catch (error) {\r\n\t    console.error('加载会议列表失败:', error)\r\n\t    meetingList.value = []\r\n\t  } finally {\r\n\t    loading.value = false\r\n\t  }\r\n\t}\r\n\t\r\n\tconst getStatusType = (status) => {\r\n\t  const types = { 0: 'warning', 1: 'success', 2: 'danger' }\r\n\t  return types[status] || 'info'\r\n\t}\r\n\t\r\n\tconst getStatusText = (status) => {\r\n\t  const texts = { 0: '待审核', 1: '已发布', 2: '已拒绝' }\r\n\t  return texts[status] || '未知'\r\n\t}\r\n\t\r\n\tconst editMeeting = (meeting) => {\r\n\t  editingMeeting.value = meeting\r\n\t  Object.assign(meetingForm, meeting)\r\n\t  showAddDialog.value = true\r\n\t}\r\n\t\r\n\tconst saveMeeting = async () => {\r\n\t  try {\r\n\t    const formData = { ...meetingForm }\r\n\t    \r\n\t    // 格式化会议时间\r\n\t    if (formData.meetingTime) {\r\n\t      if (formData.meetingTime instanceof Date) {\r\n\t        formData.meetingTime = formData.meetingTime.toISOString().slice(0, 19).replace('T', ' ')\r\n\t      }\r\n\t    }\r\n\t    \r\n\t    if (editingMeeting.value) {\r\n\t      await request.put(`/meeting/${editingMeeting.value.id}`, formData)\r\n\t      ElMessage.success('更新成功')\r\n\t    } else {\r\n\t      await request.post('/meeting', formData)\r\n\t      ElMessage.success('创建成功')\r\n\t    }\r\n\t    showAddDialog.value = false\r\n\t    resetForm()\r\n\t    loadMeetings()\r\n\t  } catch (error) {\r\n\t    console.error('保存会议失败:', error)\r\n\t  }\r\n\t}\r\n\t\r\n\tconst deleteMeeting = async (meeting) => {\r\n\t  try {\r\n\t    await ElMessageBox.confirm('确定要删除这个会议吗？', '提示')\r\n\t    await request.delete(`/meeting/${meeting.id}`)\r\n\t    ElMessage.success('删除成功')\r\n\t    loadMeetings()\r\n\t  } catch (error) {\r\n\t    if (error !== 'cancel') {\r\n\t      console.error('删除会议失败:', error)\r\n\t    }\r\n\t  }\r\n\t}\r\n\t\r\n\tconst resetForm = () => {\r\n\t  editingMeeting.value = null\r\n\t  Object.assign(meetingForm, {\r\n\t    meetingName: '',\r\n\t    meetingTime: '',\r\n\t    location: '',\r\n\t    organizer: '',\r\n\t    category: '',\r\n\t    meetingContent: '',\r\n\t    coverImage: ''\r\n\t  })\r\n\t}\r\n\t\r\n\tconst handleCoverSuccess = (response) => {\r\n\t  if (response.code === 200) {\r\n\t    meetingForm.coverImage = response.data\r\n\t    ElMessage.success('封面上传成功')\r\n\t  } else {\r\n\t    ElMessage.error('封面上传失败')\r\n\t  }\r\n\t}\r\n\t\r\n\tconst beforeUpload = (file) => {\r\n\t  const isImage = file.type.indexOf('image/') === 0\r\n\t  const isLt2M = file.size / 1024 / 1024 < 2\r\n\t\r\n\t  if (!isImage) {\r\n\t    ElMessage.error('只能上传图片文件!')\r\n\t    return false\r\n\t  }\r\n\t  if (!isLt2M) {\r\n\t    ElMessage.error('图片大小不能超过 2MB!')\r\n\t    return false\r\n\t  }\r\n\t  return true\r\n\t}\r\n\t\r\n\tconst canEdit = (meeting) => {\r\n\t  // 只有管理员或创建者本人可以编辑\r\n\t  if (!user.value || !user.value.id || !meeting) {\r\n\t    return false\r\n\t  }\r\n\t  \r\n\t  // 管理员可以编辑所有会议\r\n\t  if (user.value.role === 'ADMIN') {\r\n\t    return true\r\n\t  }\r\n\t  \r\n\t  // 创建者本人可以编辑自己的会议\r\n\t  return meeting.creatorId === user.value.id\r\n\t}\r\n\t\r\n\tconst canDelete = (meeting) => {\r\n\t  // 只有管理员或创建者本人可以删除\r\n\t  if (!user.value || !user.value.id || !meeting) {\r\n\t    return false\r\n\t  }\r\n\t  \r\n\t  // 管理员可以删除所有会议\r\n\t  if (user.value.role === 'ADMIN') {\r\n\t    return true\r\n\t  }\r\n\t  \r\n\t  // 创建者本人可以删除自己的会议\r\n\t  return meeting.creatorId === user.value.id\r\n\t}\r\n\t\r\n\tconst canAudit = (meeting) => {\r\n\t  return user.value.role === 'ADMIN' && meeting.status === 0\r\n\t}\r\n\t\r\n\tconst auditMeeting = (meeting) => {\r\n\t  auditingMeeting.value = meeting\r\n\t  auditStatus.value = 1\r\n\t  showAuditDialog.value = true\r\n\t}\r\n\t\r\n\tconst submitAudit = async () => {\r\n\t  try {\r\n\t    await request.post(`/meeting/${auditingMeeting.value.id}/audit?status=${auditStatus.value}`)\r\n\t    ElMessage.success('审核成功')\r\n\t    showAuditDialog.value = false\r\n\t    loadMeetings()\r\n\t  } catch (error) {\r\n\t    console.error('审核失败:', error)\r\n\t  }\r\n\t}\r\n\t\r\n\tconst getImageUrl = (imagePath) => {\r\n\t  if (!imagePath) return ''\r\n\t  if (imagePath.startsWith('http')) return imagePath\r\n\t  return `http://localhost:8080/api${imagePath}`\r\n\t}\r\n\t\r\n\tconst exportMeetings = async () => {\r\n\t  try {\r\n\t    const res = await request.get('/meeting/export', {\r\n\t      params: {\r\n\t        keyword: searchKeyword.value\r\n\t      },\r\n\t      responseType: 'blob'\r\n\t    })\r\n\t    \r\n\t    const blob = new Blob([res], { type: 'text/csv;charset=utf-8' })\r\n\t    const url = window.URL.createObjectURL(blob)\r\n\t    const a = document.createElement('a')\r\n\t    a.href = url\r\n\t    a.download = `meetings_${new Date().toISOString().split('T')[0]}.csv`\r\n\t    document.body.appendChild(a)\r\n\t    a.click()\r\n\t    document.body.removeChild(a)\r\n\t    window.URL.revokeObjectURL(url)\r\n\t    \r\n\t    ElMessage.success('导出成功')\r\n\t  } catch (error) {\r\n\t    console.error('导出失败:', error)\r\n\t    ElMessage.error('导出失败')\r\n\t  }\r\n\t}\r\n\t\r\n\tconst handleSizeChange = (size) => {\r\n\t  pageSize.value = size\r\n\t  currentPage.value = 1\r\n\t  loadMeetings()\r\n\t}\r\n\t\r\n\t// 重置筛选条件\r\n\tconst resetFilters = () => {\r\n\t  searchKeyword.value = ''\r\n\t  statusFilter.value = ''\r\n\t  createTimeRange.value = []\r\n\t  currentPage.value = 1\r\n\t  loadMeetings()\r\n\t}\r\n\t\r\n\t// 加载已发布的会议列表\r\n\tconst loadPublishedMeetings = async () => {\r\n\t  try {\r\n\t    const res = await request.get('/meeting/page', {\r\n\t      params: {\r\n\t        current: 1,\r\n\t        size: 100,\r\n\t        status: 1\r\n\t      }\r\n\t    })\r\n\t    publishedMeetings.value = res.data.records || []\r\n\t  } catch (error) {\r\n\t    console.error('加载已发布会议列表失败:', error)\r\n\t  }\r\n\t}\r\n\t\r\n\t// 发布通知\r\n\tconst publishNotify = async () => {\r\n\t  if (!notifyForm.title.trim()) {\r\n\t    ElMessage.error('请输入通知标题')\r\n\t    return\r\n\t  }\r\n\t  if (!notifyForm.content.trim()) {\r\n\t    ElMessage.error('请输入通知内容')\r\n\t    return\r\n\t  }\r\n\t  \r\n\t  try {\r\n\t    // 如果选择了关联会议，在标题和内容中体现\r\n\t    let title = notifyForm.title\r\n\t    let content = notifyForm.content\r\n\t    \r\n\t    if (notifyForm.meetingId) {\r\n\t      const selectedMeeting = publishedMeetings.value.find(m => m.id === notifyForm.meetingId)\r\n\t      if (selectedMeeting) {\r\n\t        title = `【会议通知】${notifyForm.title}`\r\n\t        content = `关于\"${selectedMeeting.meetingName}\"会议的通知：\\n\\n${notifyForm.content}`\r\n\t      }\r\n\t    } else {\r\n\t      title = `【会议通知】${notifyForm.title}`\r\n\t    }\r\n\t    \r\n\t    await request.post('/news', {\r\n\t      title: title,\r\n\t      content: content,\r\n\t      summary: content.substring(0, 200) + (content.length > 200 ? '...' : ''),\r\n\t      category: '会议通知',\r\n\t      status: 1\r\n\t    })\r\n\t    ElMessage.success('通知发布成功')\r\n\t    showNotifyDialog.value = false\r\n\t    resetNotifyForm()\r\n\t  } catch (error) {\r\n\t    console.error('发布通知失败:', error)\r\n\t    ElMessage.error('发布通知失败')\r\n\t  }\r\n\t}\r\n\t\r\n\t// 打开通知对话框\r\n\tconst openNotifyDialog = () => {\r\n\t  resetNotifyForm()\r\n\t  showNotifyDialog.value = true\r\n\t}\r\n\t\r\n\t// 重置通知表单\r\n\tconst resetNotifyForm = () => {\r\n\t  notifyForm.title = ''\r\n\t  notifyForm.content = ''\r\n\t  notifyForm.meetingId = null\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.card-header {\r\n\t  display: flex;\r\n\t  justify-content: space-between;\r\n\t  align-items: center;\r\n\t}\r\n\t\r\n\t.search-bar {\r\n\t  margin-bottom: 20px;\r\n\t}\r\n\t\r\n\t.search-bar .el-row {\r\n\t  align-items: center;\r\n\t}\r\n\t\r\n\t.pagination {\r\n\t  margin-top: 20px;\r\n\t  text-align: right;\r\n\t}\r\n\t\r\n\t.empty-data {\r\n\t  padding: 40px 0;\r\n\t}\r\n</style>"]}]}